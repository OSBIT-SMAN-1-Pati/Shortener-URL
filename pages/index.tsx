import { useFormik,Formik,Form,Field} from "formik";
import type { NextPage } from "next";
import Head from "next/head";
import { useState } from "react";

type formData = {
  longUrl : string,
  shortUrl :string
}

const Index: NextPage = () => {
  const [message,setMessage] = useState()
  const initialValues = {
    longUrl : "",
    shortUrl:""
  }
  const onSubmit = async (values:formData)=>{
    const {longUrl,shortUrl} = values
    const data = {
      long: longUrl,
      short:shortUrl
    }
    const response = await fetch('api/hello',{
      method: "POST",
      body: JSON.stringify(data)
    })
    const {message} = await response.json()
    setMessage(message)
  }

  const formik = useFormik({
      initialValues,
      onSubmit
    }
  )

  return (
    <>
      <Head>
        <title>shortener-url</title>
        <meta name="description" content="Generated by Create Next Stack." />
      </Head>
      <h1>Welcome to OSBIT Shortener URL</h1>
      <p>{message}</p>
      <Formik initialValues={initialValues} onSubmit={onSubmit} >
        <Form className="flex flex-col w-96">
          <label htmlFor="url-input">Input</label>
          <Field type="text" id="url-input" name="longUrl"/>
          <label htmlFor="url-shorten">shorten</label>
          <Field type="text" id="shorten-url" name="shortUrl"/>
         <button type="submit">Submit</button>
        </Form>
      </Formik>
    </>
  );
};

export default Index;